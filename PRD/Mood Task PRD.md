# Mood Task PRD

## 情绪记录

<aside>
💡

用户打开app弹出情绪评分记录弹窗（模块化）。

- 情绪评分0-100，step 10。0不可选择。
- 强制进行，不能手动关闭。记录数值后自动关闭。
</aside>

## 任务系统

<aside>
💡

根据时间和天气状况进行**任务生成（个性化+环境驱动）**

- 任务生成时间分为固定和随机两种模式。
    - 时间段：上午6-12、下午12-17、傍晚17-22、晚上22-6
        - 固定模式：到时间段的开始时间（6，12，17点）生成任务。
        - 晚上不生成任务，并且如果用户还在app内，在petview界面里弹出窗口提醒用户睡觉。
- 随机模式：根据时间和天气状况，在每个时间段内随机的时刻基于天气生成3个任务，并在选定的生成时间发送推送通知。
    - 这个随机时刻的生成时间会在每个时间段的开始时间决定。比如6点决定上午时间段在6-12中的什么时候生成任务。
        - 到时间段的开始时间（6，12，17点），获取用户当前的天气和6小时内的天气预报。
        - 极大增加在晴天的时候生成的概率，比如在早上6点、阴天的情况下，在上午的天气预报里预计9-10点是晴天，那么任务一定会在这一个小时的窗口里生成。
        - 减少在下雨的时候生成的概率。其他天气随机概率均等。
        - 颗粒度根据weatherkit实际可获取的天气预报颗粒度对齐。
	- 前一个时段的任务会一直保留到下一个时段的任务生成为止。新任务生成后，前一个时段的任务记录会归档到历史记录中。
- 根据天气随机在相关任务类型中抽取任务。任务分为不同类型，完成任务后，随机获得商店中一种食物（owned amount +1），并且根据类别增加不同的能量值。
- optional：
	- 用户可以点击加号增加自定义任务。自定义任务必须包括任务名称和类型。
	- 不同天气包括点任务类型和生成概率权重不同，比如下雨：不包括户外任务，晴天：不包括indoor digital和petcare。
	- 加入ai分析和智能推荐。

**任务页面：**

用户需要点击开始才能看到开始和完成按钮，每个任务在点击开始后需要等待倒计时结束才能点击完成。确保用户act on it。每个类别任务buffer时间不一样。

- 任务记录里的天气更新为最新的上一次获取的天气。
- 完成任务后跳出透明背景的提示，淡出后跳出透明背景的情绪反馈弹窗。均强制进行，不能关闭，期间不能屏幕其他部分不可点击。根据选择加减情绪值。
    - much worse/worse/unchanged/better/much better：-10/-5/0/+5/+10
- optional：
    - 完成户外任务和社交任务后，概率增加一种纪念品/一朵玫瑰，可以放到petview页面里。
    - health access：当天步数达到一定数量后掉落纪念品/一朵玫瑰。
    - 当前任务全部完成后出现刷新按钮，每个时间段可刷新一次。刷新时获取一次用户当前天气，并且根据天气生成3个新的任务。
    
</aside>

### CORE Functions

Detailed function design: 

- 天气与任务算法逻辑
- 随机生成任务
- 完成任务的奖励机制
- 打开app时强制情绪记录
- 完成任务后强制情绪记录
- 前后情绪对比，后台进行个性化分析

### 任务类型：

- 户外任务 outdoor：能量+15，时间5min
- 室内虚拟任务 indoorDigital：能量+5，时间3min
- 室内现实任务 indoorActivity：能量+10，时间3min
- 运动任务 Physical：能量+15，时间2min
- 社交任务 socials：能量+10，时间3min
- 宠物相关任务 petCare：能量+5，时间15s
